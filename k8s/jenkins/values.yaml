controller:
  image:
    tag: "2.479.3-lts-jdk21"
  securityContext:
    runAsUser: 1000
    fsGroup: 1000
  admin:
    existingSecret: "jenkins-admin-credentials"
    userKey: "jenkins-admin-user"
    passwordkey: "jenkins-admin-password"
  installPlugins: []
# Resource Management
  resources:
    requests:
      cpu: "100m"
      memory: "1Gi"
    limits:
      cpu: "1000m"
      memory: "2Gi"

  # Networking (Ingress)
  ingress:
    enabled: true
    ingressClassName: nginx
    hostName: jenkins.sikiru.co.uk
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-cloudflare
      # Using native annotations since snippets are disabled
      nginx.ingress.kubernetes.io/proxy-body-size: "50m"
      nginx.ingress.kubernetes.io/backend-protocol: HTTP
      nginx.ingress.kubernetes.io/force-ssl-redirect: "false"
      nginx.ingress.kubernetes.io/ssl-redirect: "false"
    tls:
      - secretName: jenkins-tls-cert
        hosts:
          - jenkins.sikiru.co.uk

  # Storage (Longhorn)
  persistence:
    enabled: true
    storageClass: longhorn
    size: "10Gi"
  # JCasC: This pre-configures Jenkins to use Keycloak on first boot
  JCasC:
    defaultConfig: true
    configScripts:
      welcome-message: |
        jenkins:
          systemMessage: "Welcome to Sikiru-Lab Jenkins CI/CD. Authenticated via Keycloak."

# Service Account for Ephemeral Agents
serviceAccount:
  create: true
  name: jenkins
